version: '{branch}.{build}'

before_build:
  - nuget restore

environment:
  COVERALLS_REPO_TOKEN:
    secure: 2Ms497ur1lidXPzesGpHAMTsmQqEDMuavbfkRKfaZiipJGplapYxCckeNJ+hYbUl
build:
  verbosity: minimal
test:
  categories:
    except:
    - skip
artifacts:
- path: bin/Relative/MK.WebLib.dll
  name: MK.WebLib.dll
after_test: 
  - .\packages\OpenCover.4.6.166\tools\OpenCover.Console.exe -register:user -filter:"+[*]*" -target:nunit-console -targetargs:"/noshadow /domain:single src\MK.WebLib.T\bin\MK.WebLib.T.dll" -output:coverage.xml
  - .\packages\coveralls.io.1.3.4\tools\coveralls.net.exe --opencover coverage.xml

notifications:
- provider: Email
  to:
  - maxkoryukov@yandex.ru
  subject: AppVeyor Notification for you, dude
  message: Something changes on AppVeyour https://ci.appveyor.com/project/maxkoryukov/mk-weblib
  on_build_success: false
  on_build_failure: false
  on_build_status_changed: true
